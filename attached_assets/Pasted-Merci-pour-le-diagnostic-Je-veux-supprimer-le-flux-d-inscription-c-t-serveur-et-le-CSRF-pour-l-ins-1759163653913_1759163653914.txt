Merci pour le diagnostic. Je veux supprimer le flux d’inscription côté serveur et le CSRF pour l’inscription : on centralise 100% sur Supabase Auth.

À faire
	1.	Remplacer l’appel POST actuel dans client/src/pages/auth/register.tsx par :

import { supabase } from '@/lib/supabase'

const { data, error } = await supabase.auth.signUp({
  email,
  password,
  options: { data: { username } } // user_metadata
})
if (error) { showToast(error.message); return }
// succès → la session peut nécessiter email confirm, gérer le cas :
navigate('/auth/callback') // ou directement vers le jeu si session active

	2.	Ne plus appeler notre endpoint serveur d’inscription et retirer la dépendance CSRF pour ce flux. L’inscription ne doit plus passer par /api/auth/register. (Conserver CSRF pour les autres POST sensibles si nécessaire, mais pas pour sign up.)
	3.	Gestion d’erreurs visible dans register.tsx :

	•	Afficher le message des erreurs non liées à username/email (pas de “silent fail”).
	•	Désactiver le bouton pendant la requête, spinner, et réactiver après.

	4.	Hooks/triggers côté DB : garder le trigger on_auth_user_created → profiles → synchro public.users (déjà en place). Vérifier qu’un signUp crée bien :
	•	auth.users (Supabase),
	•	puis public.profiles,
	•	puis public.users (sync).
	5.	Tests d’acceptation (merci de les exécuter et me coller les logs) :

	•	Cliquer Create Account crée bien un user dans auth.users (id visible dans logs).
	•	Une ligne est créée dans public.profiles et public.users (même id).
	•	En cas d’erreur (email déjà utilisé, password trop court), un toast s’affiche.
	•	Plus aucune requête POST d’inscription ne passe par notre backend (donc aucune erreur CSRF).

	6.	(Optionnel) Apple Sign-In : pour le bouton Apple, garder supabase.auth.signInWithOAuth({ provider: 'apple', options: { redirectTo: window.location.origin + '/auth/callback' }}). La page /auth/callback fait exchangeCodeForSession puis redirige vers /game.

Important
	•	Pas de contournement CSRF via token manuel : on retire le besoin de CSRF pour l’inscription en supprimant l’endpoint custom.
	•	One source of truth = Supabase Auth.

Merci de faire la modif et de me confirmer avec les captures/logs des 3 tables peuplées et l’absence d’erreur CSRF.